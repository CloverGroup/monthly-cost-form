<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>クローバーグループ 月次人件費確認フォーム</title>
  <link rel="stylesheet" href="styles.css">
  <script>
    // 新規配属者セクションの表示・非表示切替
    function toggleNewEmployeeDetails(show) {
      document.getElementById('newEmployeeDetail').style.display = show ? 'block' : 'none';
    }

    window.addEventListener('DOMContentLoaded', function() {
      // 「新規配属者」ラジオボタンの変更で表示を切り替え
      var radios = document.getElementsByName('hasNewEmployee');
      for (var i = 0; i < radios.length; i++) {
        radios[i].addEventListener('change', function() {
          toggleNewEmployeeDetails(this.value === 'yes');
        });
      }
    });

    // 新規配属者の入力欄を追加する関数
    function addNewEmployee() {
      var container = document.getElementById('newEmployeeContainer');
      var index = container.childElementCount; // インデックス用

      // 新規エントリ用の div を作成
      var div = document.createElement('div');
      div.className = 'employee-entry';

      // 氏名
      var nameLabel = document.createElement('label');
      nameLabel.textContent = '氏名: ';
      var nameInput = document.createElement('input');
      nameInput.type = 'text';
      nameInput.name = 'newEmployeeName[]';
      nameInput.placeholder = '氏名';
      nameLabel.appendChild(nameInput);
      div.appendChild(nameLabel);

      // 社員区分（社員、アルバイト、契約社員 など）
      var statusLabel = document.createElement('label');
      statusLabel.textContent = ' 社員区分: ';
      var statusSelect = document.createElement('select');
      statusSelect.name = 'newEmployeeStatus[]';
      var option1 = document.createElement('option');
      option1.value = '社員';
      option1.textContent = '社員';
      var option2 = document.createElement('option');
      option2.value = 'アルバイト';
      option2.textContent = 'アルバイト';
      var option3 = document.createElement('option');
      option3.value = '契約社員';
      option3.textContent = '契約社員';
      statusSelect.appendChild(option1);
      statusSelect.appendChild(option2);
      statusSelect.appendChild(option3);
      statusLabel.appendChild(statusSelect);
      div.appendChild(statusLabel);

      // 雇用契約書の有無（ラジオボタン）
      var contractLabel = document.createElement('label');
      contractLabel.textContent = ' 雇用契約書の有無: ';
      
      var contractYes = document.createElement('input');
      contractYes.type = 'radio';
      contractYes.name = 'employmentContract' + index;
      contractYes.value = 'あり';
      contractYes.checked = true;
      var contractYesText = document.createTextNode('あり');
      
      var contractNo = document.createElement('input');
      contractNo.type = 'radio';
      contractNo.name = 'employmentContract' + index;
      contractNo.value = 'なし';
      var contractNoText = document.createTextNode('なし');
      
      contractLabel.appendChild(contractYes);
      contractLabel.appendChild(contractYesText);
      contractLabel.appendChild(contractNo);
      contractLabel.appendChild(contractNoText);
      div.appendChild(contractLabel);

      // 追加したエントリをコンテナに追加
      container.appendChild(div);
    }
  </script>
</head>
<body>
  <div class="form-container">
    <div class="header-container">
      <h2>月次人件費確認フォーム</h2>
      <button type="button" onclick="document.querySelector('form').reset();">フォームをクリア</button>
    </div>

    <!-- GAS の Web アプリ URL を action 属性に設定 -->
    <form action="https://script.google.com/macros/s/AKfycbxgsQIH6AJRWnO5YcG3LPEay8YT_XDjSAR4qnthWhw87ALRIXG_1J8BODitxwJ90kWS/exec" method="post" enctype="multipart/form-data">
      <!-- 事業所名、報告対象月、確認メール送信先 -->
      <div class="form-group">
        <div class="header-row">
          <label for="officeName">事業所名</label>
          <input type="text" id="officeName" name="officeName" required>
        </div>
        <div class="header-row">
          <label for="reportMonth">報告対象月</label>
          <input type="month" id="reportMonth" name="reportMonth" required>
        </div>
        <div class="header-row">
          <label for="confirmationEmail">確認メール送信先</label>
          <input type="email" id="confirmationEmail" name="confirmationEmail" placeholder="xxx@day-clover.com" required>
        </div>
      </div>

      <!-- 新規配属者セクション -->
      <div class="form-group">
        <div class="section-title">
          新規配属者
          <div class="radio-group">
            <label>
              <input type="radio" name="hasNewEmployee" value="no" checked> なし
            </label>
            <label>
              <input type="radio" name="hasNewEmployee" value="yes"> あり
            </label>
          </div>
        </div>
        <!-- 「あり」選択時のみ表示 -->
        <div id="newEmployeeDetail" class="detail-section" style="display: none;">
          <!-- 入力項目を追加するためのコンテナ -->
          <div id="newEmployeeContainer">
            <!-- 初期エントリ（必要なら最初から1件表示する） -->
            <div class="employee-entry">
              <label>氏名:
                <input type="text" name="newEmployeeName[]" placeholder="氏名">
              </label>
              <label> 社員区分:
                <select name="newEmployeeStatus[]">
                  <option value="社員">社員</option>
                  <option value="アルバイト">アルバイト</option>
                  <option value="契約社員">契約社員</option>
                </select>
              </label>
              <label> 雇用契約書の有無:
                <input type="radio" name="employmentContract0" value="あり" checked> あり
                <input type="radio" name="employmentContract0" value="なし"> なし
              </label>
            </div>
          </div>
          <button type="button" class="add-button" onclick="addNewEmployee()">新規配属者を追加</button>
        </div>
      </div>

      <!-- 当月退職者 -->
      <div class="form-group">
        <div class="section-title">
          当月退職者
          <div class="radio-group">
            <label>
              <input type="radio" name="hasRetirement" value="no" checked> なし
            </label>
            <label>
              <input type="radio" name="hasRetirement" value="yes"> あり
            </label>
          </div>
        </div>
        <div id="retirementDetail" class="detail-section">
          <textarea id="retiredThisMonth" name="retiredThisMonth" placeholder="当月退職者の詳細を記入"></textarea>
          <button type="button" class="add-button" onclick="addRetirement()">退職者を追加</button>
        </div>
      </div>

      <!-- 在籍しているが勤務がない人 -->
      <div class="form-group">
        <div class="section-title">
          在籍しているが勤務がない人
          <div class="radio-group">
            <label>
              <input type="radio" name="hasNoWork" value="no" checked> なし
            </label>
            <label>
              <input type="radio" name="hasNoWork" value="yes"> あり
            </label>
          </div>
        </div>
        <div id="noWorkDetail" class="detail-section">
          <textarea id="inactiveStaff" name="inactiveStaff" placeholder="勤務がない人の詳細を記入"></textarea>
          <button type="button" class="add-button" onclick="addNoWork()">追加</button>
        </div>
      </div>

      <!-- 給与・勤務形態の変更した人 -->
      <div class="form-group">
        <div class="section-title">
          給与・勤務形態の変更した人
          <div class="radio-group">
            <label>
              <input type="radio" name="hasSalaryChange" value="no" checked> なし
            </label>
            <label>
              <input type="radio" name="hasSalaryChange" value="yes"> あり
            </label>
          </div>
        </div>
        <div id="salaryChangeDetail" class="detail-section">
          <textarea id="changedSalaryWork" name="changedSalaryWork" placeholder="給与・勤務形態変更の詳細を記入"></textarea>
          <button type="button" class="add-button" onclick="addSalaryChange()">追加</button>
        </div>
      </div>

      <!-- 住所・交通費の変更した人 -->
      <div class="form-group">
        <div class="section-title">
          住所・交通費の変更した人
          <div class="radio-group">
            <label>
              <input type="radio" name="hasAddressChange" value="no" checked> なし
            </label>
            <label>
              <input type="radio" name="hasAddressChange" value="yes"> あり
            </label>
          </div>
        </div>
        <div id="addressChangeDetail" class="detail-section">
          <textarea id="changedAddressTransport" name="changedAddressTransport" placeholder="住所・交通費変更の詳細を記入"></textarea>
          <button type="button" class="add-button" onclick="addAddressChange()">追加</button>
        </div>
      </div>

      <!-- 遅刻・早退等 -->
      <div class="form-group">
        <div class="section-title">
          遅刻・早退等
          <div class="radio-group">
            <label>
              <input type="radio" name="hasLateEarly" value="no" checked> なし
            </label>
            <label>
              <input type="radio" name="hasLateEarly" value="yes"> あり
            </label>
          </div>
        </div>
        <div id="lateEarlyDetail" class="detail-section">
          <textarea id="lateEarly" name="lateEarly" placeholder="遅刻・早退等の詳細を記入"></textarea>
          <button type="button" class="add-button" onclick="addLateEarly()">遅刻・早退を追加</button>
        </div>
      </div>

      <!-- 有給・欠勤等 -->
      <div class="form-group">
        <div class="section-title">
          有給・欠勤等
          <div class="radio-group">
            <label>
              <input type="radio" name="hasLeave" value="no" checked> なし
            </label>
            <label>
              <input type="radio" name="hasLeave" value="yes"> あり
            </label>
          </div>
        </div>
        <div id="leaveDetail" class="detail-section">
          <textarea id="paidLeaveAbsence" name="paidLeaveAbsence" placeholder="有給・欠勤等の詳細を記入"></textarea>
          <button type="button" class="add-button" onclick="addLeave()">有給・欠勤を追加</button>
        </div>
      </div>

      <!-- その他コメント -->
      <div class="form-group">
        <label for="otherComments">その他コメント</label>
        <textarea id="otherComments" name="otherComments" placeholder="その他コメントを記入"></textarea>
      </div>

      <!-- ファイルアップロード -->
      <div class="file-upload-container">
        <label for="workDataFile">勤務データファイル添付<span class="required"></span></label>
        <input type="file" id="workDataFile" name="workDataFile" class="file-input">
        <div class="note">※CSVファイルまたはExcelファイル</div>
      </div>
      <div class="file-upload-container">
        <label for="additionalMaterial">追加資料</label>
        <input type="file" id="additionalMaterial" name="additionalMaterial" class="file-input">
      </div>

      <!-- 送信ボタン -->
      <button type="submit" id="submitButton">メール送信</button>
    </form>
  </div>
</body>
</html>
