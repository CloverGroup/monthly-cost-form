<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>クローバーグループ 月次人件費確認フォーム</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="form-container">
    <div class="header-container">
      <h2>月次人件費確認フォーム</h2>
      <button type="button" onclick="clearForm()">フォームをクリア</button>
    </div>

    <!-- GAS のURLを指定 -->
    <form id="mainForm" action="https://script.google.com/macros/s/AKfycbxgsQIH6AJRWnO5YcG3LPEay8YT_XDjSAR4qnthWhw87ALRIXG_1J8BODitxwJ90kWS/exec" method="post" enctype="multipart/form-data" onsubmit="return handleSubmit(event)">
      
      <!-- 基本情報 -->
      <div class="form-group">
        <div class="header-row">
          <label for="officeName">事業所名</label>
          <input type="text" id="officeName" name="officeName" required>
        </div>
        <div class="header-row">
          <label for="reportMonth">報告対象月</label>
          <input type="month" id="reportMonth" name="reportMonth" required>
        </div>
        <div class="header-row">
          <label for="confirmationEmail">確認メール送信先</label>
          <input type="email" id="confirmationEmail" name="confirmationEmail" placeholder="xxx@day-clover.com" required>
        </div>
      </div>
      
      <!-- 新規配属者 -->
      <div class="form-group">
        <div class="section-title">
          新規配属者
          <div class="radio-group">
            <label><input type="radio" name="hasNewEmployee" value="no" checked> なし</label>
            <label><input type="radio" name="hasNewEmployee" value="yes"> あり</label>
          </div>
        </div>
        <div class="note">※他事業所のPAで、当事業所でも勤務開始する場合にも記載してください。</div>
        <div id="newEmployeeDetail" class="detail-section" style="display: none;">
          <div id="newEmployeeContainer">
            <!-- 初期エントリ例 -->
            <div class="employee-entry">
              <input type="text" name="newEmployeeName[]" placeholder="氏名">
              <div class="employee-type-group">
                <label>
                  <input type="radio" name="newEmployeeType_0" value="社員" onchange="updateEmployeeType(0, this.value)" checked> 社員
                </label>
                <label>
                  <input type="radio" name="newEmployeeType_0" value="PA" onchange="updateEmployeeType(0, this.value)"> PA
                </label>
              </div>
              <input type="hidden" name="newEmployeeType[]" id="hiddenEmployeeType_0" value="社員">
              <label class="checkbox-label">
                <input type="checkbox" name="employmentDocumentSubmitted[]" value="1">
                雇用契約書類提出済み
              </label>
              <button type="button" class="remove-button" onclick="removeEntry(this)">削除</button>
            </div>
          </div>
          <button type="button" class="add-button" onclick="addNewEmployee()">新規配属者を追加</button>
        </div>
      </div>
      
      <!-- 当月退職者 -->
      <div class="form-group">
        <div class="section-title">
          当月退職者
          <div class="radio-group">
            <label><input type="radio" name="hasRetirement" value="no" checked> なし</label>
            <label><input type="radio" name="hasRetirement" value="yes"> あり</label>
          </div>
        </div>
        <div class="note">※他事業所で勤務が継続するが、当事業所の勤務が最終の場合も記載してください。<br>※休職の場合はコメント欄にその旨を記載してください。</div>
        <div id="retirementDetail" class="detail-section" style="display: none;">
          <div id="retirementContainer"></div>
          <button type="button" class="add-button" onclick="addRetirement()">退職者を追加</button>
        </div>
      </div>
      
      <!-- 在籍しているが勤務がない人 -->
      <div class="form-group">
        <div class="section-title">
          在籍しているが勤務がない人
          <div class="radio-group">
            <label><input type="radio" name="hasNoWork" value="no" checked> なし</label>
            <label><input type="radio" name="hasNoWork" value="yes"> あり</label>
          </div>
        </div>
        <div id="noWorkDetail" class="detail-section" style="display: none;">
          <div id="noWorkContainer"></div>
          <button type="button" class="add-button" onclick="addNoWork()">追加</button>
        </div>
      </div>
      
      <!-- 給与・勤務形態の変更した人 -->
      <div class="form-group">
        <div class="section-title">
          給与・勤務形態の変更した人
          <div class="radio-group">
            <label><input type="radio" name="hasSalaryChange" value="no" checked> なし</label>
            <label><input type="radio" name="hasSalaryChange" value="yes"> あり</label>
          </div>
        </div>
        <div id="salaryChangeDetail" class="detail-section" style="display: none;">
          <div id="salaryChangeContainer"></div>
          <button type="button" class="add-button" onclick="addSalaryChange()">追加</button>
        </div>
      </div>
      
      <!-- 住所・交通費の変更した人 -->
      <div class="form-group">
        <div class="section-title">
          住所・交通費の変更した人
          <div class="radio-group">
            <label><input type="radio" name="hasAddressChange" value="no" checked> なし</label>
            <label><input type="radio" name="hasAddressChange" value="yes"> あり</label>
          </div>
        </div>
        <div id="addressChangeDetail" class="detail-section" style="display: none;">
          <div id="addressChangeContainer"></div>
          <button type="button" class="add-button" onclick="addAddressChange()">追加</button>
        </div>
      </div>
      
      <!-- 遅刻・早退等 -->
      <div class="form-group">
        <div class="section-title">
          遅刻・早退等
          <div class="radio-group">
            <label><input type="radio" name="hasLateEarly" value="no" checked> なし</label>
            <label><input type="radio" name="hasLateEarly" value="yes"> あり</label>
          </div>
        </div>
        <div id="lateEarlyDetail" class="detail-section" style="display: none;">
          <div id="lateEarlyContainer"></div>
          <button type="button" class="add-button" onclick="addLateEarly()">遅刻・早退を追加</button>
        </div>
      </div>
      
      <!-- 有給・欠勤等 -->
      <div class="form-group">
        <div class="section-title">
          有給・欠勤等
          <div class="radio-group">
            <label><input type="radio" name="hasLeave" value="no" checked> なし</label>
            <label><input type="radio" name="hasLeave" value="yes"> あり</label>
          </div>
        </div>
        <div id="leaveDetail" class="detail-section" style="display: none;">
          <div id="leaveContainer"></div>
          <button type="button" class="add-button" onclick="addLeave()">有給・欠勤を追加</button>
        </div>
      </div>
      
      <!-- その他コメント -->
      <div class="form-group">
        <label>その他コメント</label>
        <textarea id="otherComments" name="otherComments"></textarea>
      </div>
      
      <!-- ファイルアップロード -->
      <div class="file-upload-container">
        <label>勤務データファイル添付<span class="required"></span></label>
        <input type="file" id="csvFile" name="workDataFile" class="file-input">
        <div class="note">※CSVファイルまたはExcelファイル</div>
      </div>
      <div class="file-upload-container">
        <label>追加資料</label>
        <input type="file" id="optionalFile" name="additionalMaterial" class="file-input">
      </div>
      
      <!-- 送信ボタン -->
      <button type="submit" id="submitButton">メール送信</button>
    </form>
  </div>
  <script src="script.js"></script>
</body>
</html>
